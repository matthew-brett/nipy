import os.path as op

from numpy.distutils.misc_util \
    import \
        get_numpy_include_dirs

from bento.commands import hooks

@hooks.post_configure
def post_configure(context):
    conf = context.waf_context
    conf.env.INCLUDES = get_numpy_include_dirs()
    for p in ["wrapper", "fff"]:
        conf.env.INCLUDES.append(op.join("libcstat", p))
        conf.env.CYTHON_INCLUDES.append(op.join("libcstat", p))
    for p in ["segmentation", "registration"]:
        conf.env.INCLUDES.append(op.join("nipy", "algorithms", p))
    # This below only expected to work with Linux / gcc
    conf.env.CFLAGS_cstlib = ["-fPIC"]


@hooks.pre_build
def pre_build(context):
    context.tweak_extension("nipy.labs.utils.routines",
                            use = "cstat")
